import gspread
from oauth2client.service_account import ServiceAccountCredentials
from pprint import pprint

# Configura las credenciales del servicio de Google Sheets
scope = ['https://spreadsheets.google.com/feeds', 'https://www.googleapis.com/auth/drive']
credentials = ServiceAccountCredentials.from_json_keyfile_name('credentials.json', scope)
client = gspread.authorize(credentials)

# Abre la hoja de cálculo de Google Sheets con el contenido de la presentación
spreadsheet = client.open('Presentación Toulouse')
worksheet = spreadsheet.sheet1

# Crea la presentación en Google Slides
presentation = client.create('Presentación Toulouse')
slide = presentation.slides[0]

# Recorre las filas de la hoja de cálculo y agrega cada diapositiva a la presentación
for row in worksheet.get_all_records():
    slide_title = row['Titulo']
    slide_content = row['Contenido']
    slide_layout = row['Diseño']
    
    # Agrega una nueva diapositiva con el título y el contenido
    slide = presentation.slides.add_slide(presentation.slide_layouts[slide_layout])
    slide.shapes.title.text = slide_title
    slide.placeholders[1].text = slide_content

# Guarda los cambios y obtiene el enlace a la presentación
presentation_url = presentation.url
print("Presentación creada: " + presentation_url)

